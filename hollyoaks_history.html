<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hollyoaks: The First 20 Years (Modern Interactive)</title>
    <script src="https://cdn.tailwindcss.com/3.4.17" integrity="sha384-igm5BeiBt36UU4gqwWS7imYmelpTsZlQ45FZf+XBn9MuJbn4nQr7yx1yFydocC/K" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.5.1" integrity="sha384-jb8JQMbMoBUzgWatfe6COACi2ljcDdZQ2OxczGA3bGNeWe+6DChMTBJemed7ZnvJ" crossorigin="anonymous"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Modern Vibrant (Primary: Fuchsia, Secondary: Teal, Accent: Orange, Background: Light Grey/White) -->
    <!-- Application Structure Plan: A single-page, scrollable application with distinct, animated sections. A prominent Hero section introduces the app with key statistics. This leads into a dedicated section for the Thematic Evolution Chart. The Family Explorer section follows, presenting each family tree in a modern card layout, with interactive character nodes triggering an animated, Material Design-inspired modal for details. Finally, the Timeline Explorer section displays events grouped by year, with subtle scroll-in animations for each event card and a prominent year filter. This structure prioritizes dynamic content reveal and a fluid, engaging user experience. -->
    <!-- Visualization & Content Choices: 1. Family Trees (Goal: Organize/Relationships) -> Interactive HTML/CSS Diagram. Enhanced nodes with hover effects and a sleek modal for character details, including links to timeline events. 2. Storyline Evolution (Goal: Show Change) -> Chart.js Bar Chart. Custom colors for a modern look, responsive, and clear labels. 3. Timeline (Goal: Inform/Compare) -> Scrollable, Grouped List with Filter. Each year header and event card will have subtle fade-in/slide-up animations on scroll. Color-coded borders for family relevance. All elements are designed for dynamic interaction and visual appeal. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #F8FAFC; color: #1F2937; } /* Slate 50 background, Gray 800 text */
        
        /* General Section Animation */
        .section-reveal {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        }
        .section-reveal.is-visible {
            opacity: 1;
            transform: translateY(0);
        }

        /* Character Node Styling */
        .family-tree ul { padding-left: 20px; border-left: 1px solid #E5E7EB; /* Light grey border */ }
        .family-tree li { position: relative; padding-left: 20px; line-height: 1.75rem; }
        .family-tree li::before {
            content: ''; position: absolute; top: 0; left: -1px; border-top: 1px solid #E5E7EB; width: 20px; height: 50%;
        }
        .family-tree .character-node {
            cursor: pointer;
            transition: all 0.3s ease-in-out;
            background-color: #F0F9FF; /* Sky 50 */
            border: 1px solid #BFDBFE; /* Blue 200 */
            color: #1E40AF; /* Blue 800 */
            font-weight: 500;
            box-shadow: 0 1px 3px rgba(0,0,0,0.05);
        }
        .family-tree .character-node:hover {
            background-color: #E0F2FE; /* Sky 100 */
            transform: translateY(-2px) scale(1.02);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .family-tree .character-node.selected {
            background-color: #FCE7F3; /* Pink 100 */
            color: #BE185D; /* Rose 700 */
            border-color: #F472B6; /* Pink 400 */
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }

        /* Modal Animations */
        #character-modal {
            transition: opacity 0.3s ease-out, visibility 0.3s ease-out;
            opacity: 0;
            visibility: hidden;
        }
        #character-modal.is-visible {
            opacity: 1;
            visibility: visible;
        }
        #character-modal > div { /* Modal content box */
            transform: translateY(20px);
            transition: transform 0.3s ease-out;
        }
        #character-modal.is-visible > div {
            transform: translateY(0);
        }

        /* Chart Container Styling */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin-left: auto;
            margin-right: auto;
            height: 350px; /* Base height */
            max-height: 450px;
        }
        @media (min-width: 768px) {
            .chart-container { height: 400px; }
        }

        /* Timeline Event Card Animation */
        .timeline-event-card {
            opacity: 0;
            transform: translateY(10px);
            transition: opacity 0.6s ease-out, transform 0.6s ease-out;
        }
        .timeline-event-card.is-visible {
            opacity: 1;
            transform: translateY(0);
        }
    </style>
</head>
<body class="antialiased">

    <div id="app" class="max-w-7xl mx-auto p-4 md:p-8">
        
        <!-- Hero Section -->
        <section id="hero-section" class="section-reveal bg-gradient-to-br from-fuchsia-600 to-rose-500 text-white p-10 md:p-16 rounded-xl shadow-lg mb-12 text-center overflow-hidden relative">
            <h1 class="text-4xl md:text-6xl font-extrabold mb-4 animate-fade-in-up">Hollyoaks: The First 20 Years</h1>
            <p class="text-xl md:text-2xl font-light mb-8 animate-fade-in-up delay-100">An Interactive Journey Through Village Life (1996-2016)</p>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-10">
                <div class="bg-white bg-opacity-20 backdrop-filter backdrop-blur-sm p-6 rounded-lg shadow-md animate-fade-in-up delay-200">
                    <h3 class="text-3xl font-bold mb-2">3 Core Families</h3>
                    <p class="text-sm opacity-80">Cunningham, Osborne & McQueen</p>
                </div>
                <div class="bg-white bg-opacity-20 backdrop-filter backdrop-blur-sm p-6 rounded-lg shadow-md animate-fade-in-up delay-300">
                    <h3 class="text-3xl font-bold mb-2">20 Years of Drama</h3>
                    <p class="text-sm opacity-80">From teen tales to issue-led sagas</p>
                </div>
                <div class="bg-white bg-opacity-20 backdrop-filter backdrop-blur-sm p-6 rounded-lg shadow-md animate-fade-in-up delay-400">
                    <h3 class="text-3xl font-bold mb-2">100+ Key Events</h3>
                    <p class="text-sm opacity-80">Defining moments of Hollyoaks history</p>
                </div>
            </div>
            <div class="absolute inset-0 pointer-events-none">
                <div class="absolute -bottom-10 -left-10 w-48 h-48 bg-fuchsia-700 opacity-20 rounded-full mix-blend-multiply filter blur-xl animate-blob"></div>
                <div class="absolute -top-10 -right-10 w-64 h-64 bg-rose-700 opacity-20 rounded-full mix-blend-multiply filter blur-xl animate-blob animation-delay-2000"></div>
            </div>
        </section>

        <!-- Thematic Evolution Chart Section -->
        <section id="thematic-chart-section" class="section-reveal bg-white p-8 rounded-xl shadow-lg mb-12">
            <h2 class="text-3xl font-bold text-gray-800 mb-4 text-center">Thematic Evolution of Storylines</h2>
            <p class="text-gray-600 leading-relaxed mb-8 text-center max-w-3xl mx-auto">This chart illustrates how <i>Hollyoaks</i>' narrative focus shifted over two decades, moving from its teen-centric roots to embrace more complex and hard-hitting themes. This visual represents the show's deliberate evolution to tackle more mature and socially relevant issues, a key factor in its enduring popularity.</p>
            <div class="chart-container">
                <canvas id="thematicChart"></canvas>
            </div>
        </section>

        <!-- Family Explorer Section -->
        <section id="families-section" class="section-reveal bg-white p-8 rounded-xl shadow-lg mb-12">
             <h2 class="text-3xl font-bold text-gray-800 mb-4">Family Explorer</h2>
             <p class="text-gray-600 leading-relaxed mb-8">Explore the intricate relationships and individual stories of Hollyoaks' core families. The family trees below are interactive; click on any character's name to see their detailed history, key relationships, and most significant storylines from the 1996-2016 period. This view is designed to help untangle the complex web of connections that define life in Hollyoaks.</p>
            
            <div id="all-family-trees" class="space-y-10">
                <!-- Family trees will be dynamically rendered here -->
            </div>
        </section>

        <!-- Timeline Explorer Section -->
        <section id="timeline-section" class="section-reveal bg-white p-8 rounded-xl shadow-lg mb-12">
            <h2 class="text-3xl font-bold text-gray-800 mb-4">Timeline Explorer</h2>
            <p class="text-gray-600 leading-relaxed mb-8">Discover the key events that rocked Hollyoaks village year by year. Use the filter below to narrow down events by a specific year, or scroll to view the entire chronological history of major storylines, from shocking deaths and betrayals to groundbreaking moments that changed the show forever.</p>
            <div class="mt-4 flex flex-wrap justify-center items-center gap-4 mb-8">
                <label for="year-select" class="font-semibold text-lg text-gray-700">Filter by Year:</label>
                <select id="year-select" class="p-3 border border-gray-300 rounded-lg shadow-sm focus:ring-fuchsia-500 focus:border-fuchsia-500 bg-gray-50 text-gray-700 transition duration-200">
                    <option value="all">Show All Years</option>
                </select>
            </div>
            <div id="timeline-content" class="space-y-6">
                <!-- Timeline events will be rendered here, grouped by year -->
            </div>
        </section>
    </main>

    <!-- Character Detail Modal -->
    <div id="character-modal" class="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4 transition-opacity duration-300 ease-out opacity-0 invisible">
        <div class="bg-white p-8 rounded-xl shadow-2xl max-w-lg w-full relative transform scale-95 transition-transform duration-300 ease-out">
            <button id="close-modal" class="absolute top-4 right-4 text-gray-400 hover:text-gray-700 text-3xl font-light leading-none transition-colors duration-200">&times;</button>
            <div id="modal-content">
                <!-- Character details will be loaded here -->
            </div>
        </div>
    </div>

    <script>
        let appData;

        document.addEventListener('DOMContentLoaded', () => {
            const yearSelect = document.getElementById('year-select');
            const characterModal = document.getElementById('character-modal');
            const closeModalBtn = document.getElementById('close-modal');
            const modalContent = document.getElementById('modal-content');

            // Event delegation for family tree clicks - Optimization: Single listener instead of N listeners
            document.getElementById('all-family-trees').addEventListener('click', (e) => {
                const node = e.target.closest('.character-node');
                // Ensure the click is on a character node and inside the container
                if (node && document.getElementById('all-family-trees').contains(node)) {
                    // Optimization: Find only the currently selected node instead of iterating all
                    const previous = document.querySelector('.character-node.selected');
                    if (previous) previous.classList.remove('selected');

                    node.classList.add('selected');
                    showCharacterModal(node.dataset.id);
                }
            });

            // Intersection Observer for section reveal animations
            const sectionObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('is-visible');
                        sectionObserver.unobserve(entry.target); // Observe once
                    }
                });
            }, { threshold: 0.1 }); // Trigger when 10% of the section is visible

            document.querySelectorAll('.section-reveal').forEach(section => {
                sectionObserver.observe(section);
            });

            // Intersection Observer for timeline event card animations
            const timelineEventObserver = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('is-visible');
                        timelineEventObserver.unobserve(entry.target); // Observe once
                    }
                });
            }, { threshold: 0.2 }); // Trigger when 20% of the card is visible

            function buildFamilyTreeHTML(nodes) {
                if (!nodes || nodes.length === 0) return '';
                let html = '<ul>';
                nodes.forEach(node => {
                    const character = appData.characters[node.id] || { name: node.name };
                    html += `<li><span data-id="${node.id}" class="character-node rounded-md px-3 py-1.5 inline-block text-sm md:text-base">${character.name} ${node.note ? `<em class="text-xs text-gray-500 font-normal">(${node.note})</em>` : ''}</span>`;
                    if (node.children) {
                        html += buildFamilyTreeHTML(node.children);
                    }
                    html += '</li>';
                });
                html += '</ul>';
                return html;
            }

            function displayAllFamilies() {
                const allFamilyTreesContainer = document.getElementById('all-family-trees');
                allFamilyTreesContainer.innerHTML = '';

                for (const familyKey in appData.familyStructures) {
                    const familyData = appData.familyStructures[familyKey];
                    const familySection = document.createElement('div');
                    familySection.className = 'bg-blue-50 p-6 rounded-lg shadow-inner mb-6 section-reveal'; // Light blue background for family cards
                    familySection.innerHTML = `
                        <h3 class="text-2xl font-bold text-blue-800 mb-4">${familyData.name}</h3>
                        <div class="family-tree" id="tree-${familyKey}">
                            ${buildFamilyTreeHTML(familyData.tree)}
                        </div>
                    `;
                    allFamilyTreesContainer.appendChild(familySection);
                    sectionObserver.observe(familySection); // Observe for animation
                }

            }

            function showCharacterModal(charId) {
                const char = appData.characters[charId];
                if (!char) {
                    modalContent.innerHTML = `<p class="text-red-600">Details not available for this character.</p>`;
                    characterModal.classList.add('is-visible');
                    return;
                }

                let eventsHtml = '';
                // Filter timeline events relevant to this character and sort by year
                const relevantEvents = appData.timelineEvents.filter(event => 
                    event.title.includes(char.name) || (event.description && event.description.includes(char.name))
                ).sort((a,b) => a.year - b.year);

                if (relevantEvents.length > 0) {
                    eventsHtml = '<h4 class="font-semibold mt-4 mb-2 text-fuchsia-700">Key Storylines:</h4><ul class="list-disc list-inside space-y-1 text-gray-700">';
                    relevantEvents.forEach(event => {
                        eventsHtml += `<li><a href="#" data-year="${event.year}" class="event-link hover:underline text-blue-600">${event.title} (${event.year})</a></li>`;
                    });
                    eventsHtml += '</ul>';
                }

                modalContent.innerHTML = `
                    <h3 class="text-3xl font-bold text-fuchsia-800 mb-2">${char.name}</h3>
                    <p class="leading-relaxed text-gray-700">${char.summary || 'No summary available.'}</p>
                    ${eventsHtml}
                `;
                characterModal.classList.add('is-visible');

            }

            function hideCharacterModal() {
                characterModal.classList.remove('is-visible');
                document.querySelectorAll('.character-node').forEach(n => n.classList.remove('selected'));
            }

            closeModalBtn.addEventListener('click', hideCharacterModal);
            characterModal.addEventListener('click', (e) => {
                if (e.target === characterModal) {
                    hideCharacterModal();
                }
            });

            modalContent.addEventListener('click', (e) => {
                const link = e.target.closest('.event-link');
                if (link) {
                    e.preventDefault();
                    const year = link.dataset.year;
                    hideCharacterModal();
                    yearSelect.value = year;
                    displayTimeline(year);
                    document.getElementById('timeline-section').scrollIntoView({ behavior: 'smooth', block: 'start' });
                }
            });

            function populateYearSelect() {
                const years = [...new Set(appData.timelineEvents.map(event => event.year))].sort();
                yearSelect.innerHTML = '<option value="all">Show All Years</option>';
                years.forEach(year => {
                    const option = document.createElement('option');
                    option.value = year;
                    option.textContent = year;
                    yearSelect.appendChild(option);
                });
            }

            function displayTimeline(yearFilter = 'all') {
                const timelineContent = document.getElementById('timeline-content');
                timelineContent.innerHTML = '';

                let filteredEvents = appData.timelineEvents;
                if (yearFilter !== 'all') {
                    filteredEvents = appData.timelineEvents.filter(event => event.year == yearFilter);
                }

                if (filteredEvents.length === 0) {
                    timelineContent.innerHTML = '<p class="text-gray-600 text-center">No major events recorded for this selection.</p>';
                    return;
                }

                const eventsByYear = filteredEvents.reduce((acc, event) => {
                    if (!acc[event.year]) {
                        acc[event.year] = [];
                    }
                    acc[event.year].push(event);
                    return acc;
                }, {});

                const sortedYears = Object.keys(eventsByYear).sort((a, b) => a - b);
                const fragment = document.createDocumentFragment();

                sortedYears.forEach(year => {
                    const yearHeader = document.createElement('h3');
                    yearHeader.className = 'text-3xl font-extrabold text-fuchsia-700 mt-10 mb-6 border-b-2 border-fuchsia-300 pb-2 text-center section-reveal';
                    yearHeader.textContent = year;
                    fragment.appendChild(yearHeader);
                    sectionObserver.observe(yearHeader);

                    eventsByYear[year].forEach(event => {
                        const familyColors = {
                            cunningham: 'border-l-fuchsia-500 bg-fuchsia-50',
                            osborne: 'border-l-teal-500 bg-teal-50',
                            mcqueen: 'border-l-orange-500 bg-orange-50',
                            default: 'border-l-gray-300 bg-gray-50'
                        };
                        const colorClass = familyColors[event.family] || familyColors.default;

                        const eventCard = document.createElement('div');
                        eventCard.className = `timeline-event-card bg-white p-5 rounded-lg shadow-md border-l-4 ${colorClass} transition-all duration-300 ease-out hover:shadow-lg hover:scale-[1.01]`;
                        eventCard.innerHTML = `
                            <h4 class="text-xl font-semibold text-gray-800 mb-1">${event.title}</h4>
                            <p class="text-gray-600 text-sm">${event.description}</p>
                        `;
                        fragment.appendChild(eventCard);
                        timelineEventObserver.observe(eventCard);
                    });
                });
                timelineContent.appendChild(fragment);
            }
            
            yearSelect.addEventListener('change', () => displayTimeline(yearSelect.value));

            function createThematicChart() {
                const ctx = document.getElementById('thematicChart').getContext('2d');
                const themeData = {
                    '1996-2000': { 'Teen Drama': 5, 'Family Conflict': 3, 'Tragedy': 2 },
                    '2001-2005': { 'Family Conflict': 4, 'Crime': 2, 'Tragedy': 3 },
                    '2006-2010': { 'Crime': 6, 'Social Issue': 4, 'High Drama/Revenge': 5, 'Tragedy': 4 },
                    '2011-2016': { 'Social Issue': 7, 'Serial Killer': 4, 'High Drama/Revenge': 6, 'Disaster': 2 }
                };

                new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: Object.keys(themeData),
                        datasets: [
                            { label: 'Teen/Family Drama', data: [5, 4, 0, 0], backgroundColor: '#F472B6', borderRadius: 4 }, /* Pink 400 */
                            { label: 'Crime/Revenge', data: [0, 2, 11, 10], backgroundColor: '#14B8A6', borderRadius: 4 }, /* Teal 500 */
                            { label: 'Social Issue/Tragedy', data: [5, 5, 8, 9], backgroundColor: '#6366F1', borderRadius: 4 }, /* Indigo 500 */
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            x: { 
                                stacked: true,
                                grid: { display: false },
                                ticks: { color: '#4B5563' }
                            },
                            y: { 
                                stacked: true, 
                                beginAtZero: true, 
                                title: { display: true, text: 'Number of Major Storylines', color: '#4B5563' },
                                grid: { color: '#E5E7EB' },
                                ticks: { color: '#4B5563' }
                            }
                        },
                        plugins: {
                            title: { display: false },
                            legend: { labels: { color: '#4B5563' } },
                            tooltip: { 
                                mode: 'index', 
                                intersect: false,
                                backgroundColor: 'rgba(0,0,0,0.8)',
                                titleColor: '#FFFFFF',
                                bodyColor: '#FFFFFF',
                                borderColor: '#F472B6',
                                borderWidth: 1,
                                borderRadius: 6,
                                padding: 10
                            }
                        }
                    }
                });
            }

            // Event Delegation for Character Nodes - Performance Optimization
            document.getElementById('all-family-trees').addEventListener('click', (e) => {
                const node = e.target.closest('.character-node');
                // Ensure the click was on a node and inside our container
                if (node && e.currentTarget.contains(node)) {
                    // Optimized: Only query for the single previously selected element instead of iterating all
                    const previous = document.querySelector('.character-node.selected');
                    if (previous) previous.classList.remove('selected');

                    node.classList.add('selected');
                    showCharacterModal(node.dataset.id);
                }
            });

            // Initial setup

            fetch('hollyoaks_data.json')
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Network response was not ok ' + response.statusText);
                    }
                    return response.json();
                })
                .then(data => {
                    appData = data;
                    createThematicChart();
                    displayAllFamilies();
                    populateYearSelect();
                    displayTimeline('all');
                })
                .catch(error => {
                    console.error('Error loading data:', error);
                    document.getElementById('all-family-trees').innerHTML = `<p class="text-red-600">Error loading data. Please try again later.</p>`;
                });
        });
    </script>
    <style>
        /* Keyframe for blob animation */
        @keyframes blob {
            0% { transform: translate(0, 0) scale(1); }
            33% { transform: translate(30px, -50px) scale(1.1); }
            66% { transform: translate(-20px, 20px) scale(0.9); }
            100% { transform: translate(0, 0) scale(1); }
        }
        .animate-blob {
            animation: blob 7s infinite cubic-bezier(0.6, 0.01, 0.2, 1);
        }
        .animation-delay-2000 { animation-delay: 2s; }

        /* Keyframes for fade-in-up animation */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .animate-fade-in-up {
            animation: fadeInUp 0.6s ease-out forwards;
        }
        .delay-100 { animation-delay: 0.1s; }
        .delay-200 { animation-delay: 0.2s; }
        .delay-300 { animation-delay: 0.3s; }
        .delay-400 { animation-delay: 0.4s; }
    </style>
</body>
</html>
