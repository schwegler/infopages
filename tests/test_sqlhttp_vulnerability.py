
import sys

def verify():
    with open('sqlhttp.html', 'r') as f:
        content = f.read()

    # Searching for the specific part that contains the exception message leak
    vulnerable_string = '"Fabrication Error: {ex.Message}"'

    if vulnerable_string in content:
        print("Vulnerability FOUND: usage of ex.Message in return value.")
        sys.exit(1)  # Fail!
    else:
        print("Vulnerability NOT found.")
        sys.exit(0) # Pass!

if __name__ == "__main__":
    verify()
